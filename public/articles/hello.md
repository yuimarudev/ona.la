+++
published = "2025-12-02"
updated = "2025-12-05"
title = "Qwikでブログを作る"
subtitle = "逆張りオタクは最強を目指したかった"
tags = ["パソカタ", "オタク", "qwik"]

[author]
name = "ゆいまる"
link = "https://github.com/yuimarudev"

[motd]
url = "https://youtu.be/wRBNKv7eRiI"
alternative_image_url = "https://r2.ona.la/404.png"
+++

こんにちは、ゆいまるです。今日はQwikでブログを作ってみたので、思い立ったきっかけとか使ったものとか感想とか書いていこうかなと思います。

# 使ったもの・構成

## ライブラリ

- [Qwik](https://qwik.dev/)
  - Qwik City
    - †理論上最強†になるために
- [kiso.css](https://tak-dcxi.github.io/kiso.css/)
  - 日本語を美しく表示するために
  - 後述しますが、マジで最高です
- [shiki](https://shiki.matsu.io/)
  - コードブロックをハイライトするために
  - 苦しい。
- [remark](https://github.com/remarkjs/remark)
  - Markdownをパースするために
  - remark-{frontmatter, gfm}
    - メタデータや脚注やテーブルなどを扱うために
- [@napi-rs/canvas](https://github.com/Brooooooklyn/canvas)
  - OG画像を生成するために
  - 中身はskia（ネイティブライブラリ）のバインディング。node-canvasと同じく、Canvas APIを模倣したインターフェイスを露出している。
  - 実は、node-canvasよりこちらを使うほうが嬉しい。理由としては、システム依存関係がゼロであり、node-gypやpostinstallスクリプトも不要であるため。
- [glypht](https://github.com/valadaptive/glypht/tree/1feccdef57cd4adb4e3d9b76eb29e2d8fbb2a6e7)
  - フォントのサブセットを生成するために
  - おそらくこのライブラリが最強だと思います。OpenTypeフォント特性を扱えるのはこのライブラリぐらいしかないかもしれない。
- [feed](https://github.com/jpmonette/feed)
  - RSSフィードを生成するために

## フォント

- [IBM Plex Sans JP](https://www.ibm.com/plex)
  - 人間に文章を読ませるためのフォントで一番好きなため採用した

## サイトマップ

- /
  - 記事の一覧が出現
  - /about
    - このサイトについて知ることができる
  - /@\[filename\]
    - 記事が読める。中身は適当にMarkdownをパースしてレンダリングしているだけ
    - GitHubにて編集履歴を閲覧することができる
  - /feed.{xml, json}
    - RSSフィードを取得することができる

# なぜ作ろうと思ったのか

割と幼稚な理由です。かなり前からお気持ち表明に適したプラットフォームが欲しいと思っていたんですが、自分のニーズを満たせるものが[note](https://note.com/)しかないという状況で、使っていてイライラするので思い切って自分で一から作ろうと考えました。

# 細部へのこだわり集

私は頭がおかしいので、様々なサービスにおいて自分のこだわりポイントからそれている部分があると発狂して全身がDo It Yourselfになります。どこで発狂したのかを紹介していきます。

## 日本語のレンダリングをできるだけ頑張る

紙面組版の再現とまではいきませんが、最近のCSSは優秀なので、手軽に日本語を美しく描画することができます。最初は自動組版ライブラリでも作ろうかなと思っていたところ、CSSだけで自分のニーズを満たせることがわかりそちらの手法を取ることにしました。実のところ、このこだわりポイントで書いたコードはごく微量で、ほとんどが[kiso.css](https://tak-dcxi.github.io/kiso.css/)に支えられています。[TAKさんのブログ](https://www.tak-dcxi.com/article/introduce-kiso-css/)を見れば私がこのライブラリを採用した理由がわかると思います。

## 極限まで軽量化する

今デスクトップ環境で閲覧している方は、DevToolを開いて適当に2-3ページほどクロールして通信の様子を見てみてください。フロントエンドのオタクなら割と頭のおかしなことが起こっているのがわかるはずです。Qwik/QwikCityによる†理論上最強†のWebサイトである上に、ルートごとにそのルートでしか使われない文字のフォントファイルを取得していることがわかります。

## デザインを頑張らない

元々このサイトの目的としては、他人に文章を読ませるためのサイトであるというのが主目的です。長時間読んでいても疲れないような工夫をするべきなので、メインコンテンツ以外の情報をできるだけ排除しようという試みをしています。

## できるだけ多くの人々が到達できるようにする

実は、このサイトはnoscriptでも動きます。[^1] その上、[知る](/about)を見ていただければわかるんですが、curlなどの環境で閲覧できるようにするためプレーンテキストでの情報を提供しています。これによって、インターネットに接続できてかつ検閲されていないほぼすべての環境では閲覧可能になっているはずです。

# 今後の予定

## 実装したいもの

- 目次
- 自作のシンタックスハイライター
- [Moralerspace](https://github.com/yuru7/moralerspace)
  - コードブロックのフォントに採用したい
  - もちろんこれも極限まで軽量化する予定
- タグによる検索
- このサイトのリンクと外部リンクの違いを視覚的に表示する機能

---

[^1]: 嘘で、おそらく記事一覧のページネーションがうまく働かないはず。まあ`/artcles/index.json`を取得してくれればいいが、いつかいい感じにしたい。
